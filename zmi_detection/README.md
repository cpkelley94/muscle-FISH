# Detection of Z-disk/microtubule intersections (ZMIs)

## Description
We found that RNAs in muscle fibers are preferentially associated with microtubules and Z-disks. In addition, we believed by observation that RNAs associated with these cytoskeletal structures appeared to be enriched at or near Z-disk/microtubule intersections (ZMIs). To study this quantitatively, we developed a novel approach to detect perpendicular intersections between two feature masks.

## Instructions
To detect ZMIs in a myofiber microscopy image, run the following:

```
python zmi_detection.py <zdisks-tiff> <microtubules-tiff> <nuclei-tiff> <spot-info> <gene-name>
```

where `zdisks-tiff`, `microtubules-tiff`, and `nuclei-tiff` point to TIFF files containing 3D binary masks generated by the Allen Cell and Structure Segmenter, and `spot-info` points to a text file with spot positions.

## Example
First, we use the [Allen Cell and Structure Segmenter](https://www.biorxiv.org/content/10.1101/491035v2) to segment Z-disks and microtubules, and we flatten the 3D arrays into 2D using maximum intensity projection:

<img src="img/masks.png" alt="masks" width="500"/>

To fill in gaps in the Z-disk mask, we perform a single [binary closing](https://scikit-image.org/docs/dev/auto_examples/applications/plot_morphology.html) operation. We then [skeletonize](https://scikit-image.org/docs/dev/auto_examples/edges/plot_skeleton.html) both masks. We merge the skeletons into a single mask, with the following possible values at each array position:
- `0`: neither skeleton
- `1`: Z-disk skeleton only
- `2`: microtubule skeleton only
- `3`: Z-disk and microtubule skeletons